# 📊 客戶報名記錄功能 - 使用說明

## ✨ 新增功能

现在每次客户报名后，系统会**自动**：
1. ✅ 保存客户资料到 Google Sheet
2. ✅ 发送邮件给推广人员（原有功能）
3. ✅ 发送确认邮件给客户（原有功能）

**不需要任何手动操作！**

---

## 📋 Google Sheet 结构

### 同一个 Google Sheet 中会有 3 个工作表：

```
Google Sheet: 推廣人員郵箱管理
├── 工作表 1: 推廣人員 （现有）
├── 工作表 2: 評估地點 （现有）
└── 工作表 3: 客戶報名記錄 （🆕 新增，自动创建）
```

### 客戶報名記錄工作表包含以下栏位：

| 栏位 | 说明 | 示例 |
|------|------|------|
| 報名時間 | 客户提交表单的时间 | 2024/11/02 14:30:25 |
| 客戶姓名 | 客户填写的姓名 | 张三 |
| 電話號碼 | 客户电话 | +886 912345678 |
| 電子郵件 | 客户邮箱 | test@example.com |
| 國家地區 | 客户所在地区 | 台湾 Taiwan |
| 行業 | 客户行业 | 自由工作者 |
| 評估地區 | 客户选择的评估地点 | 11/3 星期一 晚上 7:00~9:00... |
| LINE ID | 客户的 LINE ID | mylineid |
| WhatsApp | 客户的 WhatsApp | +886 912345678 |
| 訂閱電子報 | 是否订阅 | 是/否 |
| 推廣代碼 | 推广代码（来自 URL） | 001 |
| 推廣人員郵箱 | 负责的推广人员 | cchaha888@gmail.com |

---

## 🚀 使用步骤

### 步骤 1：更新 Google Apps Script（3 分钟）

1. **打开** https://script.google.com
2. **找到你的项目**
3. **复制** `google-apps-script-simple.js` 的全部内容
   - 在 VS Code 中按 `Ctrl + A` 全选
   - 按 `Ctrl + C` 复制
4. **粘贴到 Code.gs**
   - 在 Apps Script 编辑器按 `Ctrl + A` 全选
   - 按 `Ctrl + V` 粘贴
5. **保存**（点击 💾 图标）
6. **重新部署**：
   - 点击「部署」→「管理部署」
   - 点击「✏️ 编辑」
   - **版本**：选择「**新版本**」
   - 点击「部署」
   - 等待 1-2 分钟

### 步骤 2：测试（1 分钟）

1. **提交一个测试表单**
2. **打开 Google Sheet**：
   ```
   https://docs.google.com/spreadsheets/d/1tvKaa07m-lxqyF4ZWgpOsC2ESiXBvNeN5IbA013lEf0/edit
   ```
3. **查看左下角**，应该会看到新的工作表：**客戶報名記錄**
4. **点击进入**，应该会看到：
   - 蓝色标题行（已自动创建）
   - 一行测试数据

**✅ 如果看到数据，说明成功了！**

---

## 💡 实际应用

### 1. 查看今天的报名

1. 打开「客戶報名記錄」工作表
2. 点击「報名時間」列
3. 点击「数据」→「创建筛选器」
4. 点击「報名時間」的筛选图标
5. 选择日期范围

### 2. 查找特定客户

1. 按 `Ctrl + F` 打开搜索
2. 输入客户姓名或电话
3. 快速定位到该客户的记录

### 3. 按推广人员筛选

1. 点击「推廣人員郵箱」列的筛选图标
2. 选择特定推广人员的邮箱
3. 只显示该推广人员的客户

### 4. 导出数据

1. 点击「文件」→「下载」
2. 选择「Microsoft Excel (.xlsx)」
3. 可以在 Excel 中进一步分析

### 5. 统计分析

**示例：统计每个评估地点的报名人数**

1. 在空白列添加公式：
   ```
   =COUNTIF(G:G, "11/3 星期一*")
   ```
2. 查看该地点的报名人数

**示例：统计每个推广人员的业绩**

1. 使用数据透视表：
   - 点击「插入」→「数据透视表」
   - 行：推廣人員郵箱
   - 值：计数（客戶姓名）
2. 自动生成业绩统计表

---

## 🎯 数据自动化

### 自动发生的事情：

1. **自动创建工作表**
   - 第一次有客户报名时，系统自动创建「客戶報名記錄」工作表
   - 自动添加蓝色标题行
   - 自动冻结标题行
   - 自动调整列宽

2. **自动添加记录**
   - 每次客户报名，自动添加一行新数据
   - 自动记录时间戳
   - 自动识别推广代码和推广人员

3. **自动格式化**
   - 标题行：蓝底白字
   - 时间格式：YYYY/MM/DD HH:MM:SS
   - 自动调整列宽

---

## 📊 示例数据

工作表看起来像这样：

| 報名時間 | 客戶姓名 | 電話號碼 | 電子郵件 | 國家地區 | 行業 | 評估地區 | LINE ID | WhatsApp | 訂閱電子報 | 推廣代碼 | 推廣人員郵箱 |
|---------|---------|---------|---------|---------|------|---------|--------|----------|----------|----------|-------------|
| 2024/11/02 14:30 | 张三 | 0912345678 | zhang@example.com | 台湾 | 自由工作者 | 11/3 星期一... | lineid123 | +886912... | 是 | 001 | cchaha888@gmail.com |
| 2024/11/02 15:45 | 李四 | 0987654321 | li@example.com | 台湾 | 美容/美发 | 11/5 星期三... | lineid456 | +886987... | 否 | 002 | a0928127137@gmail.com |

---

## 🔒 数据安全

### 访问权限

- ✅ 只有 Google Sheet 的拥有者和共享者可以查看
- ✅ 可以为不同的推广人员设置不同的权限
- ✅ 可以设置为「只能查看」防止误删

### 数据备份

**建议定期备份**：
1. 点击「文件」→「建立副本」
2. 命名为：客戶報名記錄_备份_2024-11-02
3. 每月或每周备份一次

---

## ❓ 常见问题

### Q1：如果工作表已经存在会怎样？

**答**：系统会自动检测，如果「客戶報名記錄」工作表已存在，就直接添加数据，不会重复创建。

### Q2：如果保存失败会影响邮件发送吗？

**答**：不会！即使保存到 Google Sheet 失败，邮件仍会正常发送。系统只会在日志中记录错误。

### Q3：可以修改工作表名称吗？

**答**：不建议修改。如果要改，需要同时修改 `google-apps-script-simple.js` 第 13 行的 `SHEET_NAME_CUSTOMERS`。

### Q4：可以删除旧的记录吗？

**答**：可以！但建议：
- 先导出备份
- 或移动到另一个工作表（如「历史记录」）
- 不要删除标题行

### Q5：数据会占用很多空间吗？

**答**：不会。Google Sheets 可以存储数百万行数据。即使每天 100 个报名，一年才 36,500 行，完全没问题。

---

## 📈 进阶应用

### 1. 创建仪表板

在同一个 Google Sheet 中创建一个「数据分析」工作表：
- 今日报名数
- 本周报名数
- 各地点热度排行
- 推广人员业绩排行

使用公式自动计算，实时更新！

### 2. 设置自动邮件报告

使用 Google Apps Script 定时器：
- 每天早上 9 点发送昨日报名统计
- 每周一发送上周报名统计

### 3. 连接 Google Data Studio

创建可视化报表：
- 折线图：报名趋势
- 饼图：行业分布
- 柱状图：地点热度

---

## 🎉 优势总结

### 有了这个功能，你可以：

- ✅ **随时查看**所有客户报名记录
- ✅ **快速搜索**任何客户资料
- ✅ **统计分析**报名趋势和效果
- ✅ **导出 Excel**做进一步分析
- ✅ **追踪业绩**各推广人员的成效
- ✅ **数据永久保存**不怕误删邮件
- ✅ **团队协作**多人查看同一份数据

### 而且：

- ✅ **完全自动**：不需要手动记录
- ✅ **实时更新**：报名立即显示
- ✅ **格式美观**：自动格式化
- ✅ **易于使用**：就像用 Excel 一样简单

---

## 🚀 开始使用

1. 按照「步骤 1」更新 Google Apps Script
2. 提交一个测试表单
3. 打开 Google Sheet 查看「客戶報名記錄」
4. 开始享受自动化的数据管理！

**数据就是资产！现在你有了完整的客户数据库！** 🎯

