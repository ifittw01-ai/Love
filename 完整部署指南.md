# 🚀 完整部署指南

## 📋 部署概覽

本指南將帶你完成以下步驟：
1. ✅ 創建並設置 Google Sheet（3 個頁簽）
2. ✅ 部署 Google Apps Script
3. ✅ 更新網站代碼
4. ✅ 測試整個系統

預計時間：**15-20 分鐘**

---

## 第一步：創建 Google Sheet

### 1.1 創建新的 Google Sheet
1. 前往 https://sheets.google.com
2. 點擊「空白」創建新的 Sheet
3. 將 Sheet 命名為：**AI-Global**（或任何你喜歡的名字）

### 1.2 複製 Sheet ID
從瀏覽器地址欄複製 Sheet ID：
```
https://docs.google.com/spreadsheets/d/【這裡就是ID】/edit
                                        ↑
                                   複製這段ID
```

**⚠️ 重要：** 請把 ID 記下來，稍後會用到！

---

## 第二步：設置 Google Sheet 頁簽

### 2.1 創建 3 個頁簽

#### **頁簽 1：推廣人員**
1. 將預設的「工作表1」重新命名為：**推廣人員**
2. 在第一行輸入：
   ```
   推廣代碼	郵箱	姓名
   ```
3. 從第二行開始填入推廣人員資料：
   ```
   001	promoter1@gmail.com	張三
   002	promoter2@gmail.com	李四
   003	promoter3@gmail.com	王五
   ```

#### **頁簽 2：客戶報名記錄**
1. 點擊左下角「+」新增頁簽，命名為：**客戶報名記錄**
2. 在第一行輸入：
   ```
   時間戳記	姓名	電子郵件	電話號碼	國家地區	行業	評估地區	LINE ID	WhatsApp號碼	推廣代碼
   ```
3. **第二行開始留空**（系統會自動填入客戶資料）

#### **頁簽 3：評估地點**
1. 再次點擊「+」新增頁簽，命名為：**評估地點**
2. 在第一行輸入：
   ```
   ID	國家	地點描述	是否啟用
   ```
3. 從第二行開始填入活動場次：

**台灣的活動：**
```
tw1	TW	11/25 星期一 晚上 7:00~9:00 台北市信義區忠孝東路五段123號	是
tw2	TW	11/27 星期三 下午 2:00~4:00 台中市西屯區台灣大道四段888號	是
tw3	TW	11/29 星期五 晚上 7:00~9:00 高雄市前鎮區中山四路100號	是
```

**馬來西亞的活動：**
```
my1	MY	12/1 Monday 7:00pm~9:00pm Kuala Lumpur, Jalan Ampang, Empire City Mall	是
my2	MY	12/3 Wednesday 2:00pm~4:00pm Kuala Lumpur, KLCC Convention Centre	是
my3	MY	12/5 Friday 7:00pm~9:00pm Petaling Jaya, Paradigm Mall	是
```

### 2.2 檢查清單
確認以下項目：
- [ ] 3 個頁簽都已創建
- [ ] 頁簽名稱完全正確：推廣人員、Global、評估地點
- [ ] 每個頁簽的第一行都有標題
- [ ] 推廣人員至少有 1 筆資料
- [ ] 評估地點至少有 1 筆資料（台灣或馬來西亞）
- [ ] Sheet ID 已複製

---

## 第三步：部署 Google Apps Script

### 3.1 打開 Apps Script 編輯器
1. 在 Google Sheet 中，點擊：**擴展功能** → **Apps Script**
2. 會打開一個新的標籤頁（Apps Script 編輯器）

### 3.2 複製代碼
1. 在項目中找到 `google-apps-script-updated.js` 文件
2. 複製**全部內容**
3. 回到 Apps Script 編輯器
4. **刪除**預設的代碼
5. **貼上**你複製的代碼

### 3.3 修改配置

找到第 **22 行**，修改 `SPREADSHEET_ID`：

```javascript
// 原來的：
const SPREADSHEET_ID = '1izx4MEi7coasKaULlqLQUDOmXt9qEmQ8GC0ZKfT2XvU';

// 改成你的 Sheet ID：
const SPREADSHEET_ID = '你在第一步複製的Sheet_ID';
```

找到第 **24 行**，修改 `DEFAULT_EMAIL`：

```javascript
// 原來的：
const DEFAULT_EMAIL = 'jordantsai777@gmail.com';

// 改成你的郵箱：
const DEFAULT_EMAIL = 'your-email@gmail.com';
```

### 3.4 保存
點擊上方的 **💾 儲存專案** 按鈕（或按 `Ctrl+S`）

### 3.5 部署為網頁應用程式

#### **步驟 A：新增部署作業**
1. 點擊右上角 **部署** → **新增部署作業**
2. 在「選擇類型」旁邊，點擊 **齒輪圖標 ⚙️**
3. 選擇 **網頁應用程式**

#### **步驟 B：設定部署**
填寫以下資訊：
- **說明**：`客戶表單提交系統 v1`
- **執行身份**：選擇 **我**
- **存取權限**：選擇 **所有人**

#### **步驟 C：部署**
1. 點擊 **部署** 按鈕
2. 第一次會要求授權：
   - 點擊 **審查權限**
   - 選擇你的 Google 帳號
   - 會出現「此應用程式未經驗證」警告
   - 點擊 **進階**
   - 點擊 **前往（不安全）**
   - 點擊 **允許**

#### **步驟 D：複製 URL**
部署成功後，會顯示一個「網頁應用程式」URL，類似：
```
https://script.google.com/macros/s/AKfycbXXXXXXXXXXXXXXXX.../exec
```

**⚠️ 非常重要：複製這個 URL！** 稍後需要貼到網站代碼中。

---

## 第四步：更新網站代碼

### 4.1 修改 script.js

在項目中找到 `script.js` 文件，找到第 **326 行**：

```javascript
// 原來的：
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw0pq-8iRPIThxKibSEuRCV6i4I-xigvVv1ZxFVOJ93_st2jaxrda4-8kE8S4iaURuy/exec';

// 改成你剛才複製的 URL：
const GOOGLE_SCRIPT_URL = '你在第三步複製的URL';
```

### 4.2 提交到 GitHub

在終端機中執行：

```bash
git add script.js
git commit -m "Update Google Apps Script URL"
git push
```

### 4.3 等待 GitHub Pages 更新
- GitHub Pages 通常需要 **1-2 分鐘**更新
- 前往 https://ifittw01-ai.github.io/Love/
- 重新整理頁面（按 `Ctrl+F5` 強制重新載入）

---

## 第五步：測試系統

### 5.1 測試表單提交

1. 打開網站：https://ifittw01-ai.github.io/Love/
2. 切換語言（測試語言切換功能）
3. 填寫表單：
   - 選擇「國家地區」（台灣或馬來西亞）
   - 觀察「評估地區」下拉選單是否自動更新
   - 填寫其他必填欄位
   - 在推廣代碼欄位輸入：`001`
4. 點擊「立即報名」

### 5.2 檢查結果

#### **檢查 1：Google Sheet「客戶報名記錄」頁簽**
- 應該看到新的一行數據
- 時間戳記應該是剛才提交的時間
- 所有欄位都有正確的值

#### **檢查 2：推廣人員郵箱**
- 推廣代碼 `001` 對應的推廣人員應該收到郵件
- 郵件主旨：`🎯 新客戶報名通知 - [客戶姓名]`
- 郵件內容包含客戶的完整資訊

#### **檢查 3：客戶郵箱**
- 客戶應該收到確認郵件
- 郵件主旨：`感謝您報名「AI大腦回春系統」`
- 郵件內容包含 LINE 社群連結和密碼

#### **檢查 4：垃圾郵件**
如果沒收到郵件，檢查垃圾郵件資料夾！

### 5.3 測試不同情境

#### **測試 A：台灣活動**
- 選擇國家：台灣
- 評估地區應該只顯示台灣的活動場次

#### **測試 B：馬來西亞活動**
- 選擇國家：馬來西亞
- 評估地區應該只顯示馬來西亞的活動場次

#### **測試 C：無推廣代碼**
- 不填寫推廣代碼
- 應該發送郵件到 `DEFAULT_EMAIL`

#### **測試 D：多語言**
- 切換到「English」
- 所有文字應該變成英文
- 表單仍然正常運作

---

## 🆘 故障排除

### 問題 1：授權時顯示「此應用程式未經驗證」

**解決方法：**
1. 點擊「進階」
2. 點擊「前往（不安全）」
3. 點擊「允許」

這是正常的，因為這是你自己的腳本，Google 還沒驗證它。

---

### 問題 2：提交表單後沒有反應

**檢查步驟：**

#### **A. 檢查瀏覽器控制台**
1. 按 `F12` 打開開發者工具
2. 切換到「Console」標籤
3. 查看是否有紅色錯誤訊息

常見錯誤：
- `Failed to fetch` → 檢查 GOOGLE_SCRIPT_URL 是否正確
- `CORS error` → Apps Script 沒有正確部署

#### **B. 檢查 Apps Script 執行記錄**
1. 回到 Google Apps Script 編輯器
2. 左側點擊 **執行作業**
3. 查看最近的執行記錄
4. 如果有錯誤，會顯示詳細訊息

常見錯誤：
- `Cannot find sheet '客戶報名記錄'` → 檢查頁簽名稱是否正確
- `Invalid sheet ID` → 檢查 SPREADSHEET_ID 是否正確

---

### 問題 3：Sheet 沒有收到資料

**檢查清單：**
- [ ] SPREADSHEET_ID 是否正確？
- [ ] 頁簽名稱是否完全一致？（推廣人員、客戶報名記錄、評估地點）
- [ ] 「客戶報名記錄」頁簽的第一行是否有標題？
- [ ] Apps Script 是否有執行記錄？

---

### 問題 4：沒有收到郵件

**檢查清單：**
- [ ] 檢查垃圾郵件資料夾
- [ ] 檢查「推廣人員」頁簽中的郵箱是否正確
- [ ] 檢查 DEFAULT_EMAIL 是否正確
- [ ] 查看 Apps Script 執行記錄中是否有錯誤

**常見原因：**
- Gmail 將郵件標記為垃圾郵件
- 郵箱地址輸入錯誤（多空格、拼寫錯誤）
- Google 帳號的郵件發送權限被限制（新帳號可能有限制）

---

### 問題 5：評估地區下拉選單沒有選項

**檢查清單：**
- [ ] 「評估地點」頁簽是否有資料？
- [ ] 「國家」欄位是否填 `TW` 或 `MY`（必須大寫）？
- [ ] 「是否啟用」欄位是否填 `是` 或留空？
- [ ] Apps Script 的 SPREADSHEET_ID 是否正確？

**測試方法：**
1. 在瀏覽器中訪問：
   ```
   https://script.google.com/.../exec?action=getRegions&country=TW
   ```
   （把 URL 換成你的 Apps Script URL）
2. 應該看到 JSON 格式的地點列表
3. 如果顯示錯誤，查看錯誤訊息

---

## 📊 系統架構圖

```
┌─────────────────────────────────────────────────────────────┐
│                        使用者                                │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ↓
┌─────────────────────────────────────────────────────────────┐
│                   GitHub Pages 網站                          │
│  - index.html (表單)                                         │
│  - script.js (前端邏輯)                                      │
│  - translations.js (多語言)                                  │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ↓
┌─────────────────────────────────────────────────────────────┐
│                 Google Apps Script                           │
│  - 接收表單資料                                              │
│  - 儲存到 Google Sheet                                       │
│  - 發送郵件通知                                              │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ↓
┌─────────────────────────────────────────────────────────────┐
│                    Google Sheet                              │
│  頁簽1: 推廣人員 (推廣代碼 ↔ 郵箱)                          │
│  頁簽2: 客戶報名記錄 (客戶資料)                             │
│  頁簽3: 評估地點 (活動場次)                                 │
└─────────────────────────────────────────────────────────────┘
```

---

## 🎯 完成檢查清單

部署完成後，確認以下項目：

### Google Sheet
- [ ] 已創建 3 個頁簽：推廣人員、客戶報名記錄、評估地點
- [ ] 每個頁簽的第一行都有標題
- [ ] 推廣人員至少有 1 筆資料
- [ ] 評估地點至少有 2 筆資料（台灣 1 筆 + 馬來西亞 1 筆）
- [ ] Sheet ID 已複製

### Google Apps Script
- [ ] 代碼已貼上
- [ ] SPREADSHEET_ID 已修改（第 22 行）
- [ ] DEFAULT_EMAIL 已修改（第 24 行）
- [ ] 已保存
- [ ] 已部署為「網頁應用程式」
- [ ] 已授權
- [ ] 部署 URL 已複製

### 網站代碼
- [ ] script.js 的 GOOGLE_SCRIPT_URL 已更新（第 326 行）
- [ ] 已提交到 GitHub
- [ ] GitHub Pages 已更新

### 測試
- [ ] 網站可以正常打開
- [ ] 語言切換功能正常
- [ ] 選擇國家後，評估地區選項會自動更新
- [ ] 提交表單後，「客戶報名記錄」頁簽有新資料
- [ ] 推廣人員收到郵件
- [ ] 客戶收到確認郵件

---

## 🎉 部署成功！

恭喜你！系統已經完全部署並運作了！

### 接下來你可以：

1. ✅ **新增更多推廣人員**
   - 在「推廣人員」頁簽中新增資料
   - 系統會自動讀取

2. ✅ **新增或修改活動場次**
   - 在「評估地點」頁簽中新增資料
   - 直接拖動行來調整順序
   - 修改「是否啟用」來顯示/隱藏地點

3. ✅ **查看客戶資料**
   - 在「客戶報名記錄」頁簽中查看所有提交的資料
   - 可以匯出為 CSV 或 Excel

4. ✅ **分享推廣連結**
   - 基本網址：`https://ifittw01-ai.github.io/Love/`
   - 帶推廣代碼：`https://ifittw01-ai.github.io/Love/?ref=001`

---

**最後更新：2024-11-20**

需要幫助？查看其他文檔：
- `Google-Sheet-最終結構說明.md` - Google Sheet 詳細結構
- `評估地點-最終簡化版.md` - 評估地點設置指南

